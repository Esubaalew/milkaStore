<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Method</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f0f2f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .payment-card {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-radius: 15px;
            padding: 30px;
            background-color: white;
            transition: all 0.3s ease;
        }
        .payment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
        }
        .btn-primary {
            background-color: #4CAF50;
            border: none;
            padding: 12px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .instructions {
            margin-top: 20px;
            font-size: 1.1rem;
            font-weight: 500;
            color: #333;
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            border-left: 5px solid #4CAF50;
        }
        .form-check-input:checked {
            background-color: #4CAF50;
            border-color: #4CAF50;
        }
        .form-check-label {
            font-weight: 500;
            color: #333;
        }
        h1 {
            color: #2c3e50;
            font-weight: 700;
            margin-bottom: 30px;
        }
        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .language-switcher button {
            background-color: transparent;
            border: none;
            font-size: 1.2rem;
            margin-left: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .language-switcher button:hover {
            transform: scale(1.1);
        }
        .payment-icon {
            font-size: 1.5rem;
            margin-right: 10px;
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="payment-card">
                    <div class="language-switcher">
                        <button id="enButton"><i class="fas fa-flag-usa"></i></button>
                        <button id="amButton"><i class="fas fa-flag"></i> ኢት</button>
                    </div>
                    <h1 id="paymentTitle" class="text-center mb-4">Select Payment Method for {{ order.product.name }}</h1>
                    
                    <div class="card mb-4 bg-light">
                        <div class="card-body">
                            <p id="quantityText" class="mb-2"><strong>Quantity:</strong> {{ order.quantity }}</p>
                            <p id="totalPriceText" class="mb-0"><strong>Total Price:</strong> {{ order.total_price }} Birr</p>
                        </div>
                    </div>
                    
                    <form id="paymentForm" method="POST">
                        {% csrf_token %}
                        <div class="mb-4">
                            <label class="form-label h5" id="paymentMethodLabel">Payment Method</label>
                            <div class="list-group">
                                <label class="list-group-item d-flex align-items-center">
                                    <input class="form-check-input me-3" type="radio" id="cbe" name="payment_method" value="cbe" required>
                                    <i class="fas fa-university payment-icon"></i> Commercial Bank of Ethiopia
                                </label>
                                <label class="list-group-item d-flex align-items-center">
                                    <input class="form-check-input me-3" type="radio" id="boa" name="payment_method" value="boa" required>
                                    <i class="fas fa-university payment-icon"></i> Bank of Abyssinia
                                </label>
                                <label class="list-group-item d-flex align-items-center">
                                    <input class="form-check-input me-3" type="radio" id="awash" name="payment_method" value="awash" required>
                                    <i class="fas fa-university payment-icon"></i> Awash Bank
                                </label>
                                <label class="list-group-item d-flex align-items-center">
                                    <input class="form-check-input me-3" type="radio" id="enat" name="payment_method" value="enat" required>
                                    <i class="fas fa-university payment-icon"></i> Enat Bank
                                </label>
                                <label class="list-group-item d-flex align-items-center">
                                    <input class="form-check-input me-3" type="radio" id="dashen" name="payment_method" value="dashen" required>
                                    <i class="fas fa-university payment-icon"></i> Dashen Bank
                                </label>
                                <label class="list-group-item d-flex align-items-center">
                                    <input class="form-check-input me-3" type="radio" id="cash" name="payment_method" value="cash" required>
                                    <i class="fas fa-money-bill-wave payment-icon"></i> Cash
                                </label>
                                <label class="list-group-item d-flex align-items-center disabled">
                                    <input class="form-check-input me-3" type="radio" id="chapa" name="payment_method" value="chapa" disabled>
                                    <i class="fas fa-credit-card payment-icon"></i> Chapa (Coming Soon)
                                </label>
                                <label class="list-group-item d-flex align-items-center disabled">
                                    <input class="form-check-input me-3" type="radio" id="telebirr" name="payment_method" value="telebirr" disabled>
                                    <i class="fas fa-mobile-alt payment-icon"></i> Telebirr (Coming Soon)
                                </label>
                            </div>
                        </div>
                        
                        <div class="instructions" id="instructions"></div>
                        
                        <div class="mb-4" id="paymentRefContainer">
                            <label for="paymentRef" class="form-label h5" id="paymentRefLabel">Payment Reference</label>
                            <input type="text" class="form-control form-control-lg" id="paymentRef" name="payment_ref" required>
                        </div>
                        
                        <button type="submit" class="btn btn-primary w-100" id="submitButton">Submit Payment</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const submitButton = document.querySelector('button[type="submit"]');
        const instructionsDiv = document.getElementById('instructions');
        const paymentRefContainer = document.getElementById('paymentRefContainer');
        const paymentRefInput = document.getElementById('paymentRef');
        const paymentTitle = document.getElementById('paymentTitle');
        const quantityText = document.getElementById('quantityText');
        const totalPriceText = document.getElementById('totalPriceText');

        const instructions = {
            cbe: `Transfer the total price of {{ order.total_price }} birr to the Commercial Bank of Ethiopia. Use account number: {{ random_account_number }}.`,
            boa: `Transfer the total price of {{ order.total_price }} birr to the Bank of Abyssinia. Use account number: {{ random_account_number }}.`,
            awash: `Transfer the total price of {{ order.total_price }} birr to Awash Bank. Use account number: {{ random_account_number }}.`,
            enat: `Transfer the total price of {{ order.total_price }} birr to Enat Bank. Use account number: {{ random_account_number }}.`,
            dashen: `Transfer the total price of {{ order.total_price }} birr to Dashen Bank. Use account number: {{ random_account_number }}.`,
            cash: `Please pay the total amount of {{ order.total_price }} birr in cash upon delivery.`,
            chapa: `Chapa payment is coming soon. Please choose another payment method.`,
            telebirr: `Telebirr payment is coming soon. Please choose another payment method.`
        };

        // Amharic translations
const instructionsAm = {
    cbe: `እባኮዎትን የአጠቃላይ ዋጋ ወደ ኢትዮጵያ ንግድ ባንክ ብር {{ order.total_price }} ይላኩ። ባንክ ቁጥር : {{ random_account_number }}.`,
    boa: `እባክዎትን የአጠቃላይ ዋጋ ወደ አቢሲኒያ ባንክ ብር {{ order.total_price }} ይላኩ። ባንክ ቁጥር : {{ random_account_number }}.`,
    awash: `እባክዎትን የአጠቃላይ ዋጋ ወደ አዋሽ ባንክ ብር {{ order.total_price }} ይላኩ። ባንክ ቁጥር : {{ random_account_number }}.`,
    enat: `እባክዎትን የአጠቃላይ ዋጋ ወደ እናት ባንክ ብር {{ order.total_price }} ይላኩ። ባንክ ቁጥር : {{ random_account_number }}.`,
    dashen: `እባክዎትን የአጠቃላይ ዋጋ ወደ ዳሽን ባንክ ብር {{ order.total_price }} ይላኩ። ባንክ ቁጥር: {{ random_account_number }}.`,
    cash: `እባኮትን የአጠቃላይ ዋጋ ብር {{ order.total_price }} ይክፈሉ ።`,
    chapa: `የቻፓ ክፍያ በቅርብ ቀን ይጨመራል ። እባኮትን ሌላ የክፍያ ዘዴ ይምረጡ።`,
    telebirr: `የቴሌብር ክፍያ በቅርብ ቀን ይጨመራል ። እባኮትን ሌላ የክፍያ ዘዴ ይምረጡ።`,
};


        function updateInstructions() {
            const selectedMethod = document.querySelector('input[name="payment_method"]:checked');
            if (selectedMethod) {
                const methodValue = selectedMethod.value;
                instructionsDiv.innerHTML = savedLanguage === 'am' ? instructionsAm[methodValue] : instructions[methodValue];

                if (methodValue === 'cash') {
                    paymentRefContainer.style.display = 'none';
                    paymentRefInput.removeAttribute('required');
                } else {
                    paymentRefContainer.style.display = 'block';
                    paymentRefInput.setAttribute('required', 'required');
                }
            } else {
                instructionsDiv.innerHTML = '';
            }
        }

        // Add event listener to radio buttons
        document.querySelectorAll('input[name="payment_method"]').forEach(input => {
            input.addEventListener('change', updateInstructions);
        });

        document.getElementById('paymentForm').addEventListener('submit', function(event) {
            submitButton.innerHTML = savedLanguage === 'am' ? 'ክፍያ ይላኩ' : 'Submit Payment';
        });

        // Initialize instructions based on the selected radio button
        updateInstructions();

        // Language switching logic
        const languageContent = {
            en: {
                paymentTitle: "Select Payment Method for {{ order.product.name }}",
                quantityText: "Quantity: {{ order.quantity }}",
                totalPriceText: "Total Price: {{ order.total_price }} Birr",
                paymentMethodLabel: "Payment Method",
                paymentRefLabel: "Payment Reference",
            },
            am: {
                paymentTitle: "የክፍያ ዘዴ ይምረጡ ለ{{ order.product.name }}",
                quantityText: "ብዛት: {{ order.quantity }}",
                totalPriceText: "ጠቅላላ ዋጋ: {{ order.total_price }} ብር",
                paymentMethodLabel: "የክፍያ ዘዴ",
                paymentRefLabel: "የክፍያ ማረጋገጫ ኮድ",
            }
        };

        // Load saved language from localStorage or default to English
        const savedLanguage = localStorage.getItem('selectedLanguage') || 'en';

        function switchLanguage(language) {
            localStorage.setItem('selectedLanguage', language);
            const content = languageContent[language];
            paymentTitle.innerHTML = content.paymentTitle;
            quantityText.innerHTML = content.quantityText;
            totalPriceText.innerHTML = content.totalPriceText;
            document.getElementById('paymentMethodLabel').innerHTML = content.paymentMethodLabel;
            document.getElementById('paymentRefLabel').innerHTML = content.paymentRefLabel;
            submitButton.innerHTML = language === 'am' ? 'ክፍያ ይላኩ' : 'Submit Payment';
        }

        // Initialize language
        switchLanguage(savedLanguage);

        // Language button events
        const languageButtons = {
            enButton: document.getElementById('enButton'),
            amButton: document.getElementById('amButton')
        };

        languageButtons.enButton.addEventListener('click', () => switchLanguage('en'));
        languageButtons.amButton.addEventListener('click', () => switchLanguage('am'));
    </script>
</body>
</html>
